BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%salmon%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2727657589.56752
 ALGERIA                   |   1997 | 4634984989.77938
 ALGERIA                   |   1996 | 4648468553.37448
 ALGERIA                   |   1995 | 4641370065.14338
 ALGERIA                   |   1994 | 4633266727.03618
 ALGERIA                   |   1993 | 4633190395.00619
 ALGERIA                   |   1992 | 4672396459.96771
 ARGENTINA                 |   1998 | 2726990972.20607
 ARGENTINA                 |   1997 | 4637284105.56371
 ARGENTINA                 |   1996 | 4671862597.09368
 ARGENTINA                 |   1995 | 4648924659.08959
 ARGENTINA                 |   1994 | 4634658233.49039
 ARGENTINA                 |   1993 | 4647790121.56994
 ARGENTINA                 |   1992 | 4670745807.09332
 BRAZIL                    |   1998 | 2730476299.82339
 BRAZIL                    |   1997 | 4670817253.06916
 BRAZIL                    |   1996 | 4663769497.47413
 BRAZIL                    |   1995 | 4646927113.78465
 BRAZIL                    |   1994 |  4663917271.6872
 BRAZIL                    |   1993 | 4655696429.88108
 BRAZIL                    |   1992 |  4677983022.7007
 CANADA                    |   1998 | 2762479349.93729
 CANADA                    |   1997 | 4685786404.70311
 CANADA                    |   1996 |  4675385468.1709
 CANADA                    |   1995 |  4702651870.5354
 CANADA                    |   1994 | 4666484740.93015
 CANADA                    |   1993 | 4677919032.62095
 CANADA                    |   1992 | 4698402199.67788
 CHINA                     |   1998 | 2742247385.43815
 CHINA                     |   1997 | 4670606026.95457
 CHINA                     |   1996 | 4711325657.33198
 CHINA                     |   1995 | 4657077900.72415
 CHINA                     |   1994 | 4681070399.34714
 CHINA                     |   1993 | 4659603963.53968
 CHINA                     |   1992 | 4704697493.80961
 EGYPT                     |   1998 | 2724189055.94773
 EGYPT                     |   1997 | 4627562231.42172
 EGYPT                     |   1996 | 4626941551.94913
 EGYPT                     |   1995 | 4657877238.05642
 EGYPT                     |   1994 | 4653756809.67505
 EGYPT                     |   1993 | 4658029207.43056
 EGYPT                     |   1992 | 4659763462.39347
 ETHIOPIA                  |   1998 | 2738536368.84452
 ETHIOPIA                  |   1997 | 4660514368.25348
 ETHIOPIA                  |   1996 | 4694768801.27859
 ETHIOPIA                  |   1995 | 4654187536.00469
 ETHIOPIA                  |   1994 | 4656021120.98665
 ETHIOPIA                  |   1993 | 4680264732.59265
 ETHIOPIA                  |   1992 | 4668557824.30896
 FRANCE                    |   1998 | 2762002817.57172
 FRANCE                    |   1997 | 4692237406.65814
 FRANCE                    |   1996 |  4722699362.6965
 FRANCE                    |   1995 | 4695953730.23249
 FRANCE                    |   1994 |  4687574304.2496
 FRANCE                    |   1993 |  4698101538.5799
 FRANCE                    |   1992 | 4714825245.75941
 GERMANY                   |   1998 | 2763577263.08377
 GERMANY                   |   1997 | 4693406128.87348
 GERMANY                   |   1996 | 4704251029.96772
 GERMANY                   |   1995 | 4693353411.66424
 GERMANY                   |   1994 | 4683213371.90712
 GERMANY                   |   1993 | 4686962882.04175
 GERMANY                   |   1992 | 4705206301.95017
 INDIA                     |   1998 | 2722885806.92559
 INDIA                     |   1997 | 4656540975.14723
 INDIA                     |   1996 | 4649563149.64676
 INDIA                     |   1995 | 4657120475.61759
 INDIA                     |   1994 | 4668866502.36334
 INDIA                     |   1993 | 4657496596.38449
 INDIA                     |   1992 | 4647629232.47124
 INDONESIA                 |   1998 |  2716844460.4287
 INDONESIA                 |   1997 | 4651039296.30107
 INDONESIA                 |   1996 |  4617567947.6978
 INDONESIA                 |   1995 | 4638043944.14706
 INDONESIA                 |   1994 | 4640732430.50727
 INDONESIA                 |   1993 | 4641577979.65585
 INDONESIA                 |   1992 | 4654578250.33042
 IRAN                      |   1998 | 2741282787.44819
 IRAN                      |   1997 | 4662816480.19549
 IRAN                      |   1996 | 4643751794.19186
 IRAN                      |   1995 |  4654825269.8418
 IRAN                      |   1994 | 4661095364.46909
 IRAN                      |   1993 | 4646759137.33122
 IRAN                      |   1992 | 4642883197.66726
 IRAQ                      |   1998 | 2725357464.03119
 IRAQ                      |   1997 | 4671431730.71076
 IRAQ                      |   1996 | 4655418329.93162
 IRAQ                      |   1995 | 4632004552.08923
 IRAQ                      |   1994 | 4642416702.62948
 IRAQ                      |   1993 | 4650807227.65629
 IRAQ                      |   1992 | 4665773679.93816
 JAPAN                     |   1998 | 2731752129.43466
 JAPAN                     |   1997 | 4644816924.60545
 JAPAN                     |   1996 | 4655531559.91475
 JAPAN                     |   1995 | 4654015168.22531
 JAPAN                     |   1994 | 4619663168.91396
 JAPAN                     |   1993 | 4636426452.00672
 JAPAN                     |   1992 | 4642382327.88163
 JORDAN                    |   1998 |   2742331935.964
 JORDAN                    |   1997 |  4653911284.5287
 JORDAN                    |   1996 | 4656018816.82562
 JORDAN                    |   1995 | 4631346410.51377
 JORDAN                    |   1994 | 4650972813.04208
 JORDAN                    |   1993 | 4649328409.51783
 JORDAN                    |   1992 | 4652542092.17546
 KENYA                     |   1998 | 2712668875.06928
 KENYA                     |   1997 | 4619972708.60941
 KENYA                     |   1996 | 4645964327.22463
 KENYA                     |   1995 | 4610642719.19875
 KENYA                     |   1994 |  4627552771.6855
 KENYA                     |   1993 | 4611253358.90486
 KENYA                     |   1992 | 4650295722.01104
 MOROCCO                   |   1998 |  2730681966.7023
 MOROCCO                   |   1997 | 4673817277.53996
 MOROCCO                   |   1996 | 4706895365.71989
 MOROCCO                   |   1995 | 4679469438.64662
 MOROCCO                   |   1994 | 4667863562.61146
 MOROCCO                   |   1993 | 4685270081.71747
 MOROCCO                   |   1992 | 4691072326.39141
 MOZAMBIQUE                |   1998 | 2724662678.79575
 MOZAMBIQUE                |   1997 | 4665292012.42066
 MOZAMBIQUE                |   1996 | 4688215269.77703
 MOZAMBIQUE                |   1995 | 4659430289.94658
 MOZAMBIQUE                |   1994 | 4664648643.91422
 MOZAMBIQUE                |   1993 | 4664542817.06281
 MOZAMBIQUE                |   1992 | 4672082523.53041
 PERU                      |   1998 | 2718221406.25594
 PERU                      |   1997 |  4644207628.6918
 PERU                      |   1996 | 4657220473.12109
 PERU                      |   1995 | 4636914196.55427
 PERU                      |   1994 | 4651202574.41713
 PERU                      |   1993 | 4633336539.75866
 PERU                      |   1992 | 4649930699.23988
 ROMANIA                   |   1998 | 2733156187.08059
 ROMANIA                   |   1997 |  4672855262.6112
 ROMANIA                   |   1996 | 4676063592.26982
 ROMANIA                   |   1995 | 4659642592.15216
 ROMANIA                   |   1994 | 4687888448.99251
 ROMANIA                   |   1993 | 4683459999.58737
 ROMANIA                   |   1992 | 4676808762.16502
 RUSSIA                    |   1998 | 2727657685.15919
 RUSSIA                    |   1997 | 4666473076.60389
 RUSSIA                    |   1996 | 4647860195.58222
 RUSSIA                    |   1995 | 4655048733.89194
 RUSSIA                    |   1994 | 4659900895.87482
 RUSSIA                    |   1993 |   4635002004.991
 RUSSIA                    |   1992 | 4671049139.30512
 SAUDI ARABIA              |   1998 |  2722930802.4768
 SAUDI ARABIA              |   1997 | 4655328924.74605
 SAUDI ARABIA              |   1996 | 4650060550.08766
 SAUDI ARABIA              |   1995 | 4651327099.42153
 SAUDI ARABIA              |   1994 | 4667236551.74961
 SAUDI ARABIA              |   1993 | 4638477806.55705
 SAUDI ARABIA              |   1992 | 4655607053.94079
 UNITED KINGDOM            |   1998 | 2771314923.10158
 UNITED KINGDOM            |   1997 | 4711384268.81253
 UNITED KINGDOM            |   1996 | 4698454890.12679
 UNITED KINGDOM            |   1995 | 4695348757.71023
 UNITED KINGDOM            |   1994 | 4717391974.25171
 UNITED KINGDOM            |   1993 | 4696624711.76982
 UNITED KINGDOM            |   1992 | 4739773251.64642
 UNITED STATES             |   1998 | 2730955393.65238
 UNITED STATES             |   1997 |  4675283997.9879
 UNITED STATES             |   1996 | 4676522817.97411
 UNITED STATES             |   1995 |   4679344151.994
 UNITED STATES             |   1994 | 4674845555.72474
 UNITED STATES             |   1993 | 4656677898.95991
 UNITED STATES             |   1992 | 4673194037.48015
 VIETNAM                   |   1998 | 2743362026.24803
 VIETNAM                   |   1997 | 4644259117.27096
 VIETNAM                   |   1996 | 4700418841.08874
 VIETNAM                   |   1995 | 4711000960.43235
 VIETNAM                   |   1994 | 4679857187.90534
 VIETNAM                   |   1993 |  4676881501.0995
 VIETNAM                   |   1992 | 4681233080.68164
(175 rows)

COMMIT;
COMMIT
