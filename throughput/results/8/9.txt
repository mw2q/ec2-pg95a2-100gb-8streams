BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%goldenrod%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2729426057.78099
 ALGERIA                   |   1997 | 4632391364.15219
 ALGERIA                   |   1996 | 4654256088.73783
 ALGERIA                   |   1995 | 4665855544.17255
 ALGERIA                   |   1994 | 4638579333.30135
 ALGERIA                   |   1993 | 4670958890.86283
 ALGERIA                   |   1992 | 4624309756.80978
 ARGENTINA                 |   1998 | 2729606800.10772
 ARGENTINA                 |   1997 | 4633947022.96583
 ARGENTINA                 |   1996 | 4664089091.58827
 ARGENTINA                 |   1995 |   4630043504.443
 ARGENTINA                 |   1994 | 4644663833.53953
 ARGENTINA                 |   1993 | 4633848383.43029
 ARGENTINA                 |   1992 | 4631026917.57492
 BRAZIL                    |   1998 | 2762598455.73117
 BRAZIL                    |   1997 | 4662641349.94006
 BRAZIL                    |   1996 | 4678082606.56424
 BRAZIL                    |   1995 | 4661879665.56386
 BRAZIL                    |   1994 | 4663618518.46758
 BRAZIL                    |   1993 | 4679582203.32607
 BRAZIL                    |   1992 | 4649904302.07278
 CANADA                    |   1998 | 2740100003.36512
 CANADA                    |   1997 | 4650139809.14994
 CANADA                    |   1996 | 4670298112.98095
 CANADA                    |   1995 | 4645949708.46742
 CANADA                    |   1994 | 4641976909.06361
 CANADA                    |   1993 | 4661533303.94963
 CANADA                    |   1992 | 4675678131.67928
 CHINA                     |   1998 |  2752964308.7118
 CHINA                     |   1997 |  4674029691.4208
 CHINA                     |   1996 | 4701010923.80671
 CHINA                     |   1995 | 4661134915.44666
 CHINA                     |   1994 | 4667060359.60435
 CHINA                     |   1993 | 4652130210.05893
 CHINA                     |   1992 | 4693806221.67779
 EGYPT                     |   1998 |   2730472118.892
 EGYPT                     |   1997 | 4646974779.19533
 EGYPT                     |   1996 |  4688353875.1384
 EGYPT                     |   1995 | 4677847835.15562
 EGYPT                     |   1994 | 4660747675.02547
 EGYPT                     |   1993 | 4676904572.61012
 EGYPT                     |   1992 | 4674599756.53208
 ETHIOPIA                  |   1998 | 2741903552.95613
 ETHIOPIA                  |   1997 | 4711912629.57194
 ETHIOPIA                  |   1996 | 4720417471.93217
 ETHIOPIA                  |   1995 | 4728240158.66224
 ETHIOPIA                  |   1994 |  4710966321.2262
 ETHIOPIA                  |   1993 | 4691681042.67672
 ETHIOPIA                  |   1992 | 4728872459.41271
 FRANCE                    |   1998 | 2757449180.63168
 FRANCE                    |   1997 | 4710418560.50039
 FRANCE                    |   1996 | 4726964785.73534
 FRANCE                    |   1995 | 4693917328.59873
 FRANCE                    |   1994 | 4723572985.79716
 FRANCE                    |   1993 |   4728301357.859
 FRANCE                    |   1992 | 4719803378.70843
 GERMANY                   |   1998 |  2764857622.2548
 GERMANY                   |   1997 | 4674127359.61507
 GERMANY                   |   1996 | 4695973041.45501
 GERMANY                   |   1995 | 4655245867.15749
 GERMANY                   |   1994 | 4677005351.81163
 GERMANY                   |   1993 |   4705565946.851
 GERMANY                   |   1992 | 4709176194.76538
 INDIA                     |   1998 | 2733524866.47783
 INDIA                     |   1997 | 4647636795.44718
 INDIA                     |   1996 |  4673555565.1048
 INDIA                     |   1995 | 4668229704.62493
 INDIA                     |   1994 | 4651796649.83419
 INDIA                     |   1993 | 4657639139.06556
 INDIA                     |   1992 | 4662715727.69576
 INDONESIA                 |   1998 | 2737876019.92605
 INDONESIA                 |   1997 | 4635468573.45937
 INDONESIA                 |   1996 | 4637212606.35149
 INDONESIA                 |   1995 | 4613399390.47425
 INDONESIA                 |   1994 | 4647569094.03355
 INDONESIA                 |   1993 | 4628005513.10569
 INDONESIA                 |   1992 | 4639871120.66335
 IRAN                      |   1998 |  2727159829.8197
 IRAN                      |   1997 | 4632819284.36197
 IRAN                      |   1996 | 4640031875.52439
 IRAN                      |   1995 | 4623843036.03237
 IRAN                      |   1994 | 4642233204.75118
 IRAN                      |   1993 | 4640174063.81437
 IRAN                      |   1992 | 4669467503.68045
 IRAQ                      |   1998 | 2713612008.21155
 IRAQ                      |   1997 | 4659734352.83388
 IRAQ                      |   1996 | 4657741099.65017
 IRAQ                      |   1995 | 4652065353.66367
 IRAQ                      |   1994 |  4638964899.1643
 IRAQ                      |   1993 | 4668162692.14352
 IRAQ                      |   1992 | 4662450216.54208
 JAPAN                     |   1998 | 2713263640.12025
 JAPAN                     |   1997 | 4642937940.35465
 JAPAN                     |   1996 | 4684862336.60584
 JAPAN                     |   1995 | 4670609418.82588
 JAPAN                     |   1994 | 4667640153.58395
 JAPAN                     |   1993 | 4641429919.71787
 JAPAN                     |   1992 | 4653786371.21955
 JORDAN                    |   1998 | 2731038963.19678
 JORDAN                    |   1997 | 4657669323.98585
 JORDAN                    |   1996 | 4676769194.35178
 JORDAN                    |   1995 | 4650340469.92054
 JORDAN                    |   1994 | 4666125411.20183
 JORDAN                    |   1993 | 4622279377.71715
 JORDAN                    |   1992 |  4653421967.6421
 KENYA                     |   1998 | 2746323603.64851
 KENYA                     |   1997 | 4640038903.18324
 KENYA                     |   1996 |  4670686500.4349
 KENYA                     |   1995 | 4674235258.85926
 KENYA                     |   1994 | 4644805912.96175
 KENYA                     |   1993 | 4652634764.45299
 KENYA                     |   1992 | 4664565861.03644
 MOROCCO                   |   1998 | 2734117210.42471
 MOROCCO                   |   1997 | 4688994319.50689
 MOROCCO                   |   1996 | 4700970608.93877
 MOROCCO                   |   1995 | 4694260943.36379
 MOROCCO                   |   1994 | 4650074186.08722
 MOROCCO                   |   1993 | 4663877515.82938
 MOROCCO                   |   1992 | 4662024391.11493
 MOZAMBIQUE                |   1998 | 2741532273.61349
 MOZAMBIQUE                |   1997 |   4653196199.458
 MOZAMBIQUE                |   1996 | 4697138702.34156
 MOZAMBIQUE                |   1995 | 4654721686.18072
 MOZAMBIQUE                |   1994 | 4664019830.00685
 MOZAMBIQUE                |   1993 | 4655922218.31026
 MOZAMBIQUE                |   1992 | 4693617453.22059
 PERU                      |   1998 | 2697847901.82646
 PERU                      |   1997 | 4612237708.19845
 PERU                      |   1996 | 4631047932.38417
 PERU                      |   1995 |  4636555887.6561
 PERU                      |   1994 | 4624194013.70801
 PERU                      |   1993 | 4614240425.23602
 PERU                      |   1992 | 4640277640.62076
 ROMANIA                   |   1998 | 2750408292.86044
 ROMANIA                   |   1997 | 4698107593.63949
 ROMANIA                   |   1996 | 4669795540.03709
 ROMANIA                   |   1995 | 4689148796.39074
 ROMANIA                   |   1994 | 4688009441.51071
 ROMANIA                   |   1993 | 4667317181.56063
 ROMANIA                   |   1992 | 4698756032.81175
 RUSSIA                    |   1998 | 2723530567.77773
 RUSSIA                    |   1997 | 4697903916.89731
 RUSSIA                    |   1996 | 4657385597.22874
 RUSSIA                    |   1995 | 4656047221.24353
 RUSSIA                    |   1994 |  4658799435.5146
 RUSSIA                    |   1993 | 4677049747.49765
 RUSSIA                    |   1992 | 4687018452.30255
 SAUDI ARABIA              |   1998 | 2718701414.42912
 SAUDI ARABIA              |   1997 | 4637629689.64579
 SAUDI ARABIA              |   1996 | 4701293848.68588
 SAUDI ARABIA              |   1995 | 4665441452.76299
 SAUDI ARABIA              |   1994 | 4677050017.60497
 SAUDI ARABIA              |   1993 | 4661496138.94202
 SAUDI ARABIA              |   1992 | 4673899296.59324
 UNITED KINGDOM            |   1998 | 2750071065.73721
 UNITED KINGDOM            |   1997 |    4690226104.05
 UNITED KINGDOM            |   1996 | 4696431801.45459
 UNITED KINGDOM            |   1995 | 4657994970.92808
 UNITED KINGDOM            |   1994 | 4696069673.19649
 UNITED KINGDOM            |   1993 | 4697234640.50996
 UNITED KINGDOM            |   1992 | 4709192225.37697
 UNITED STATES             |   1998 | 2763995835.70701
 UNITED STATES             |   1997 | 4690732863.56716
 UNITED STATES             |   1996 | 4715425900.55093
 UNITED STATES             |   1995 | 4650893411.92223
 UNITED STATES             |   1994 | 4672884198.77909
 UNITED STATES             |   1993 | 4691221916.07343
 UNITED STATES             |   1992 | 4718391336.59768
 VIETNAM                   |   1998 | 2745735448.87369
 VIETNAM                   |   1997 |  4688124374.5409
 VIETNAM                   |   1996 | 4680189659.07282
 VIETNAM                   |   1995 | 4678101772.25915
 VIETNAM                   |   1994 | 4701713695.55405
 VIETNAM                   |   1993 | 4683904861.88998
 VIETNAM                   |   1992 | 4688517741.40041
(175 rows)

COMMIT;
COMMIT
