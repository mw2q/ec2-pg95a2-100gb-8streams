BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%navy%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 |  2732164304.1033
 ALGERIA                   |   1997 | 4697241751.00821
 ALGERIA                   |   1996 | 4675802079.75926
 ALGERIA                   |   1995 | 4674482942.25057
 ALGERIA                   |   1994 | 4661740768.22921
 ALGERIA                   |   1993 | 4663267139.48159
 ALGERIA                   |   1992 | 4650268263.44625
 ARGENTINA                 |   1998 | 2722041886.46244
 ARGENTINA                 |   1997 | 4637483618.31575
 ARGENTINA                 |   1996 | 4666743293.08769
 ARGENTINA                 |   1995 | 4621822995.32873
 ARGENTINA                 |   1994 | 4665902425.81024
 ARGENTINA                 |   1993 | 4641285844.49142
 ARGENTINA                 |   1992 | 4640929723.95252
 BRAZIL                    |   1998 | 2751842728.98947
 BRAZIL                    |   1997 | 4694544620.23081
 BRAZIL                    |   1996 | 4705466409.85869
 BRAZIL                    |   1995 | 4671295973.30907
 BRAZIL                    |   1994 | 4651324885.02422
 BRAZIL                    |   1993 | 4678752492.94897
 BRAZIL                    |   1992 | 4677677845.40854
 CANADA                    |   1998 | 2729698472.98486
 CANADA                    |   1997 | 4678931287.14838
 CANADA                    |   1996 | 4713734830.47629
 CANADA                    |   1995 | 4693988124.46775
 CANADA                    |   1994 | 4687642030.24879
 CANADA                    |   1993 | 4666292007.72952
 CANADA                    |   1992 | 4714367125.07905
 CHINA                     |   1998 | 2741467593.57896
 CHINA                     |   1997 |  4669577298.5577
 CHINA                     |   1996 | 4671783839.72047
 CHINA                     |   1995 | 4655646651.99976
 CHINA                     |   1994 | 4656673597.52803
 CHINA                     |   1993 | 4677544829.31283
 CHINA                     |   1992 | 4682411556.07622
 EGYPT                     |   1998 | 2726471245.52909
 EGYPT                     |   1997 | 4668167215.79395
 EGYPT                     |   1996 | 4679349794.45508
 EGYPT                     |   1995 | 4673038694.71721
 EGYPT                     |   1994 | 4643442692.84083
 EGYPT                     |   1993 | 4678177508.88783
 EGYPT                     |   1992 | 4690124701.92429
 ETHIOPIA                  |   1998 | 2785094821.50826
 ETHIOPIA                  |   1997 | 4740473262.18156
 ETHIOPIA                  |   1996 | 4761720208.70472
 ETHIOPIA                  |   1995 | 4752478196.68009
 ETHIOPIA                  |   1994 |  4746489798.2401
 ETHIOPIA                  |   1993 | 4738874560.11665
 ETHIOPIA                  |   1992 | 4749121218.52236
 FRANCE                    |   1998 |  2736908112.3445
 FRANCE                    |   1997 |  4688321108.3428
 FRANCE                    |   1996 | 4718031206.64149
 FRANCE                    |   1995 | 4675399270.98736
 FRANCE                    |   1994 | 4705206667.19497
 FRANCE                    |   1993 | 4679748190.86901
 FRANCE                    |   1992 | 4720795930.76621
 GERMANY                   |   1998 | 2732614699.41442
 GERMANY                   |   1997 | 4682235802.25927
 GERMANY                   |   1996 | 4698013366.98097
 GERMANY                   |   1995 | 4693909361.39484
 GERMANY                   |   1994 | 4675020791.46924
 GERMANY                   |   1993 | 4696686752.48865
 GERMANY                   |   1992 | 4672723548.67268
 INDIA                     |   1998 | 2740550732.86609
 INDIA                     |   1997 | 4658391309.04875
 INDIA                     |   1996 | 4682865267.32254
 INDIA                     |   1995 | 4668109470.57723
 INDIA                     |   1994 |  4644755516.1052
 INDIA                     |   1993 | 4681247308.43271
 INDIA                     |   1992 | 4674596752.32788
 INDONESIA                 |   1998 | 2724369731.30185
 INDONESIA                 |   1997 | 4627673632.76432
 INDONESIA                 |   1996 | 4607208642.81648
 INDONESIA                 |   1995 | 4631105336.71209
 INDONESIA                 |   1994 | 4619008275.97734
 INDONESIA                 |   1993 | 4642808694.51354
 INDONESIA                 |   1992 |  4620793267.2104
 IRAN                      |   1998 | 2732295418.55622
 IRAN                      |   1997 | 4657296345.57323
 IRAN                      |   1996 | 4684184341.19977
 IRAN                      |   1995 | 4679865652.00114
 IRAN                      |   1994 | 4666320667.47152
 IRAN                      |   1993 | 4694424912.10147
 IRAN                      |   1992 | 4688523600.83793
 IRAQ                      |   1998 | 2744502342.34653
 IRAQ                      |   1997 | 4647697346.01057
 IRAQ                      |   1996 | 4638662586.34361
 IRAQ                      |   1995 | 4637108293.30267
 IRAQ                      |   1994 | 4652984645.93277
 IRAQ                      |   1993 | 4633970987.01565
 IRAQ                      |   1992 | 4648004636.13401
 JAPAN                     |   1998 | 2733509770.94498
 JAPAN                     |   1997 | 4645628260.69376
 JAPAN                     |   1996 | 4651893176.13405
 JAPAN                     |   1995 |  4629185032.0915
 JAPAN                     |   1994 | 4645444921.63993
 JAPAN                     |   1993 | 4666439902.53876
 JAPAN                     |   1992 | 4641146801.73884
 JORDAN                    |   1998 | 2718524367.75975
 JORDAN                    |   1997 | 4641427376.79321
 JORDAN                    |   1996 | 4660160469.74969
 JORDAN                    |   1995 | 4638709538.01281
 JORDAN                    |   1994 | 4650345465.40431
 JORDAN                    |   1993 | 4646851800.89149
 JORDAN                    |   1992 | 4667562849.45213
 KENYA                     |   1998 | 2723388699.15337
 KENYA                     |   1997 | 4613930418.35621
 KENYA                     |   1996 | 4652425718.85001
 KENYA                     |   1995 | 4632292457.97716
 KENYA                     |   1994 | 4615055472.19164
 KENYA                     |   1993 | 4633145382.60174
 KENYA                     |   1992 |  4646051870.1646
 MOROCCO                   |   1998 | 2764377198.19824
 MOROCCO                   |   1997 | 4736705178.76697
 MOROCCO                   |   1996 | 4726403091.63173
 MOROCCO                   |   1995 | 4714534468.01812
 MOROCCO                   |   1994 |  4728948299.8771
 MOROCCO                   |   1993 | 4704452914.69638
 MOROCCO                   |   1992 | 4712761660.99465
 MOZAMBIQUE                |   1998 | 2762096927.71194
 MOZAMBIQUE                |   1997 |  4700917726.0793
 MOZAMBIQUE                |   1996 | 4717342890.92858
 MOZAMBIQUE                |   1995 | 4714117341.49175
 MOZAMBIQUE                |   1994 | 4720916746.56628
 MOZAMBIQUE                |   1993 | 4713606073.66022
 MOZAMBIQUE                |   1992 | 4705013953.87202
 PERU                      |   1998 | 2718272642.76011
 PERU                      |   1997 | 4641937186.17522
 PERU                      |   1996 | 4658039485.48326
 PERU                      |   1995 | 4659156633.73758
 PERU                      |   1994 |  4646824667.7298
 PERU                      |   1993 | 4636779616.51482
 PERU                      |   1992 | 4665893859.30433
 ROMANIA                   |   1998 | 2727336263.11541
 ROMANIA                   |   1997 | 4701989050.65445
 ROMANIA                   |   1996 |  4677462155.5213
 ROMANIA                   |   1995 | 4692259236.48994
 ROMANIA                   |   1994 |  4683391450.0434
 ROMANIA                   |   1993 | 4696750594.94157
 ROMANIA                   |   1992 | 4701111102.87689
 RUSSIA                    |   1998 |  2738385658.8544
 RUSSIA                    |   1997 | 4682300878.00819
 RUSSIA                    |   1996 | 4683955590.11916
 RUSSIA                    |   1995 | 4686903045.36036
 RUSSIA                    |   1994 | 4666586664.09257
 RUSSIA                    |   1993 | 4677442680.74171
 RUSSIA                    |   1992 | 4689111193.62827
 SAUDI ARABIA              |   1998 | 2725715780.88434
 SAUDI ARABIA              |   1997 | 4672595866.22934
 SAUDI ARABIA              |   1996 |  4694405030.5905
 SAUDI ARABIA              |   1995 | 4659269144.50344
 SAUDI ARABIA              |   1994 | 4674774266.53813
 SAUDI ARABIA              |   1993 | 4661136348.72977
 SAUDI ARABIA              |   1992 | 4677045040.68704
 UNITED KINGDOM            |   1998 | 2764066462.52403
 UNITED KINGDOM            |   1997 | 4697617216.87626
 UNITED KINGDOM            |   1996 | 4717032093.06757
 UNITED KINGDOM            |   1995 | 4687566504.98904
 UNITED KINGDOM            |   1994 | 4709359111.60506
 UNITED KINGDOM            |   1993 | 4717487557.79927
 UNITED KINGDOM            |   1992 | 4720420235.73489
 UNITED STATES             |   1998 | 2738966477.85729
 UNITED STATES             |   1997 |  4681268774.2665
 UNITED STATES             |   1996 | 4680489632.08125
 UNITED STATES             |   1995 | 4681870659.01471
 UNITED STATES             |   1994 |  4691610455.4197
 UNITED STATES             |   1993 | 4670054683.41776
 UNITED STATES             |   1992 | 4678966502.83275
 VIETNAM                   |   1998 | 2753217707.19011
 VIETNAM                   |   1997 | 4681574575.34039
 VIETNAM                   |   1996 | 4693585455.98807
 VIETNAM                   |   1995 |  4690675841.6744
 VIETNAM                   |   1994 | 4708536412.59269
 VIETNAM                   |   1993 | 4686105099.38543
 VIETNAM                   |   1992 | 4697692454.47539
(175 rows)

COMMIT;
COMMIT
