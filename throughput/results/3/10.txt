BEGIN;
BEGIN
select
	c_custkey,
	c_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	c_acctbal,
	n_name,
	c_address,
	c_phone,
	c_comment
from
	customer,
	orders,
	lineitem,
	nation
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate >= date '1993-10-01'
	and o_orderdate < cast(date '1993-10-01' + interval '3 month' as date)
	and l_returnflag = 'R'
	and c_nationkey = n_nationkey
group by
	c_custkey,
	c_name,
	c_acctbal,
	c_phone,
	n_name,
	c_address,
	c_comment
order by
	revenue desc
LIMIT 20;
 c_custkey |       c_name       |     revenue      | c_acctbal |          n_name           |                c_address                 |     c_phone     |                                                      c_comment                                                       
-----------+--------------------+------------------+-----------+---------------------------+------------------------------------------+-----------------+----------------------------------------------------------------------------------------------------------------------
   7450894 | Customer#007450894 | 936768.838362638 |    927.18 | ARGENTINA                 | hxPXtdJ84fyOre7gMSCv2rzBvt cw5G3S4aivxm  | 11-833-256-7879 | packages are inside the finally bold requests. final, ironic ideas doze slyly regular deposit
   9739771 | Customer#009739771 | 842966.532048476 |   1286.48 | JORDAN                    | tC7c8bZ7 By6nEoHRL                       | 23-281-450-4794 | p furiously deposits? deposits affix furiously: pinto beans are blithely after the slyly final accounts. ca
   1601743 | Customer#001601743 | 842647.244169274 |   1622.55 | ARGENTINA                 | qMxtWfmOf7J8iQ6                          | 11-248-580-8725 | unts. slyly bold pinto beans are fluffily above the bold, pending account
   4571035 | Customer#004571035 | 838705.618509422 |   6704.13 | UNITED KINGDOM            | 20IDf0Fx1ahSqImFXAEMSopHx3ic,h8Lj        | 33-138-285-3770 | e carefully across the quickly ironic requests! fluffily close instructions cajole carefully. furious
    637855 | Customer#000637855 | 812034.378965796 |   2674.86 | MOZAMBIQUE                | q5TskwlicGP                              | 26-852-120-2850 | al instructions sleep blithely. furiously final platelets nag across the ca
  10781974 | Customer#010781974 |  801735.51473618 |   5079.77 | ROMANIA                   | Cv2p,eRTt8C  WwJV61XTYA,6T4obB           | 29-651-722-6239 | egular notornis. requests wake alongsid
   1259743 | Customer#001259743 | 793274.786929707 |   2592.74 | ETHIOPIA                  | YVe ,jDra4xnKtfzS62bnoxpmGF2d8Kfi        | 15-733-636-6732 | eposits sleep according to the even pinto beans. carefully un
   5154136 | Customer#005154136 | 787191.199083163 |   1028.97 | MOROCCO                   | Y,cjCdRGVz1j g8YQUGRMf5z3R               | 25-841-379-9394 | boost quickly slyly even deposits: slyly ironic theodolite
  14986552 | Customer#014986552 | 781645.853406481 |   2678.94 | ARGENTINA                 | tl5yB8W1C0                               | 11-671-762-3613 | ual ideas sleep daringly after the carefully final pinto beans. furiously final accounts at th
   2905816 | Customer#002905816 | 778729.439149411 |   5085.53 | UNITED STATES             | bcLOp3b9PA                               | 34-217-584-5820 |  the furiously express foxes wake final, pending pinto beans. slyly silent ideas nag slyly. foxes sleep slyly accord
   6184141 | Customer#006184141 | 772721.096069856 |   5901.88 | BRAZIL                    | YouilzzEFBn8Q6atx F76                    | 12-563-743-4211 | en instructions between the furiously ironic pinto beans wake blithely bold deposits. fluffy p
   7852024 | Customer#007852024 | 769688.663932063 |   1197.57 | INDIA                     | 2 lZJ,yBgPkRHVO6yDnXeehlynZEt,W8SU4J46,R | 18-141-580-3886 | osits haggle quickly. ironic dependencies against the daringly express requests wak
   7183231 | Customer#007183231 |  768455.87766081 |   -683.01 | INDIA                     | ozSXeIbCwiOQJhN                          | 18-270-127-8463 | braids. furiously ironic instructions nag blithely around the carefully regular asymptotes. regular packages after t
   1627651 | Customer#001627651 | 768300.292633773 |   3059.82 | MOROCCO                   | cp3JS2a9Yu8cBKaDrTlpMirm1l1rpDo          | 25-732-202-4862 | ts cajole carefully along the carefully final requests. special packages affix. blithely final accounts agai
  13624771 | Customer#013624771 | 767856.161210835 |   -168.68 | IRAN                      | sxMG5r82qFaZLAqmChvOLDNaqm               | 20-919-886-5399 | the, final requests mold slyly according to the slyly final
   6708331 | Customer#006708331 | 763772.539482602 |   9352.29 | JORDAN                    | tvdoqwGYZbvNBS3yK                        | 23-237-733-1687 | ly platelets. carefully enticing accounts boost furiously after the regular, expre
  13896424 | Customer#013896424 | 760957.619085713 |   3798.91 | INDONESIA                 | csALLLLaTB                               | 19-494-837-4503 |  cajole carefully above the carefully regular deposits. slyly fluffy accounts boost blithely reg
   4926817 | Customer#004926817 |  758756.85382966 |   5462.22 | RUSSIA                    | X9PvpAssUMkoi                            | 32-610-751-1595 | carefully unusual deposits haggle doggedly along
   7072129 | Customer#007072129 | 757509.491538951 |   4246.05 | ALGERIA                   | pHZDll2VCXThUUjGJ3M8BEhabta              | 10-304-208-9285 | uctions integrate around the unusual, regular reques
    319150 | Customer#000319150 | 757235.889233692 |   3257.68 | IRAN                      | l1KV7LZ3ih7cgjuQUo0iXJTb wlIvIzwD        | 20-837-276-7259 | ly ironic requests. ironic deposits beyond the fu
(20 rows)

COMMIT;
COMMIT
